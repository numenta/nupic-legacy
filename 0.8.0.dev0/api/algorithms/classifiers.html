<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Classifiers &#8212; NuPIC 0.8.0.dev0
 documentation</title>
    
    <link rel="stylesheet" href="../../_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../',
        VERSION:     '0.8.0.dev0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Anomaly Detection" href="anomaly-detection.html" />
    <link rel="prev" title="Sequence Memory" href="sequence-memory.html" />
   
  <link rel="stylesheet" href="../../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head>
  <body role="document">
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="classifiers">
<h1>Classifiers<a class="headerlink" href="#classifiers" title="Permalink to this headline">¶</a></h1>
<div class="section" id="module-nupic.algorithms.sdr_classifier">
<span id="sdr-classifier"></span><h2>SDR Classifier<a class="headerlink" href="#module-nupic.algorithms.sdr_classifier" title="Permalink to this headline">¶</a></h2>
<p>Implementation of a SDR classifier.</p>
<p>The SDR classifier takes the form of a single layer classification network
that takes SDRs as input and outputs a predicted distribution of classes.</p>
<dl class="class">
<dt id="nupic.algorithms.sdr_classifier.SDRClassifier">
<em class="property">class </em><code class="descclassname">nupic.algorithms.sdr_classifier.</code><code class="descname">SDRClassifier</code><span class="sig-paren">(</span><em>steps=(1</em>, <em>)</em>, <em>alpha=0.001</em>, <em>actValueAlpha=0.3</em>, <em>verbosity=0</em><span class="sig-paren">)</span><a class="headerlink" href="#nupic.algorithms.sdr_classifier.SDRClassifier" title="Permalink to this definition">¶</a></dt>
<dd><p>The SDR Classifier accepts a binary input pattern from the
level below (the &#8220;activationPattern&#8221;) and information from the sensor and
encoders (the &#8220;classification&#8221;) describing the true (target) input.</p>
<p>The SDR classifier maps input patterns to class labels. There are as many
output units as the number of class labels or buckets (in the case of scalar
encoders). The output is a probabilistic distribution over all class labels.</p>
<p>During inference, the output is calculated by first doing a weighted summation
of all the inputs, and then perform a softmax nonlinear function to get
the predicted distribution of class labels</p>
<p>During learning, the connection weights between input units and output units
are adjusted to maximize the likelihood of the model</p>
<p>The SDR Classifier is a variation of the previous CLAClassifier which was
not based on the references below.</p>
<p>Example Usage:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">c</span> <span class="o">=</span> <span class="n">SDRClassifier</span><span class="p">(</span><span class="n">steps</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">actValueAlpha</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">verbosity</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

<span class="c1"># learning</span>
<span class="n">c</span><span class="o">.</span><span class="n">compute</span><span class="p">(</span><span class="n">recordNum</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">patternNZ</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">9</span><span class="p">],</span>
          <span class="n">classification</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;bucketIdx&quot;</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span> <span class="s2">&quot;actValue&quot;</span><span class="p">:</span> <span class="mf">34.7</span><span class="p">},</span>
          <span class="n">learn</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">infer</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>

<span class="c1"># inference</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">compute</span><span class="p">(</span><span class="n">recordNum</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">patternNZ</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">9</span><span class="p">],</span>
                   <span class="n">classification</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;bucketIdx&quot;</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span> <span class="s2">&quot;actValue&quot;</span><span class="p">:</span> <span class="mf">34.7</span><span class="p">},</span>
                   <span class="n">learn</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">infer</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>

<span class="c1"># Print the top three predictions for 1 steps out.</span>
<span class="n">topPredictions</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">result</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
                        <span class="n">result</span><span class="p">[</span><span class="s2">&quot;actualValues&quot;</span><span class="p">]),</span> <span class="n">reverse</span><span class="o">=</span><span class="bp">True</span><span class="p">)[:</span><span class="mi">3</span><span class="p">]</span>
<span class="k">for</span> <span class="n">probability</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">topPredictions</span><span class="p">:</span>
  <span class="k">print</span> <span class="s2">&quot;Prediction of {} has probability of {}.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">value</span><span class="p">,</span>
                                                         <span class="n">probability</span><span class="o">*</span><span class="mf">100.0</span><span class="p">)</span>
</pre></div>
</div>
<p>References:</p>
<ul class="simple">
<li>Alex Graves. Supervised Sequence Labeling with Recurrent Neural Networks,
PhD Thesis, 2008</li>
<li>J. S. Bridle. Probabilistic interpretation of feedforward classification
network outputs, with relationships to statistical pattern recognition</li>
<li>In F. Fogleman-Soulie and J.Herault, editors, Neurocomputing: Algorithms,
Architectures and Applications, pp 227-236, Springer-Verlag, 1990</li>
</ul>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>steps</strong> &#8211; (list) Sequence of the different steps of multi-step predictions
to learn</li>
<li><strong>alpha</strong> &#8211; (float) The alpha used to adapt the weight matrix during
learning. A larger alpha results in faster adaptation to the data.</li>
<li><strong>actValueAlpha</strong> &#8211; (float) Used to track the actual value within each
bucket. A lower actValueAlpha results in longer term memory</li>
<li><strong>verbosity</strong> &#8211; (int) verbosity level, can be 0, 1, or 2</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="nupic.algorithms.sdr_classifier.SDRClassifier.compute">
<code class="descname">compute</code><span class="sig-paren">(</span><em>recordNum</em>, <em>patternNZ</em>, <em>classification</em>, <em>learn</em>, <em>infer</em><span class="sig-paren">)</span><a class="headerlink" href="#nupic.algorithms.sdr_classifier.SDRClassifier.compute" title="Permalink to this definition">¶</a></dt>
<dd><p>Process one input sample.</p>
<p>This method is called by outer loop code outside the nupic-engine. We
use this instead of the nupic engine compute() because our inputs and
outputs aren&#8217;t fixed size vectors of reals.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>recordNum</strong> &#8211; Record number of this input pattern. Record numbers
normally increase sequentially by 1 each time unless there are missing
records in the dataset. Knowing this information insures that we don&#8217;t get
confused by missing records.</li>
<li><strong>patternNZ</strong> &#8211; List of the active indices from the output below. When the
input is from TemporalMemory, this list should be the indices of the
active cells.</li>
<li><strong>classification</strong> &#8211; <p>Dict of the classification information where:</p>
<ul>
<li>bucketIdx: index of the encoder bucket</li>
<li>actValue: actual value going into the encoder</li>
</ul>
<p>Classification could be None for inference mode.</p>
</li>
<li><strong>learn</strong> &#8211; (bool) if true, learn this sample</li>
<li><strong>infer</strong> &#8211; (bool) if true, perform inference</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><p>Dict containing inference results, there is one entry for each
step in self.steps, where the key is the number of steps, and
the value is an array containing the relative likelihood for
each bucketIdx starting from bucketIdx 0.</p>
<p>There is also an entry containing the average actual value to
use for each bucket. The key is &#8216;actualValues&#8217;.</p>
<p>for example:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="p">{</span><span class="mi">1</span> <span class="p">:</span>             <span class="p">[</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.7</span><span class="p">],</span>
  <span class="mi">4</span> <span class="p">:</span>             <span class="p">[</span><span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">],</span>
  <span class="s1">&#39;actualValues&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">1.5</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span> <span class="mf">7.6</span><span class="p">],</span>
<span class="p">}</span>
</pre></div>
</div>
</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="nupic.algorithms.sdr_classifier.SDRClassifier.infer">
<code class="descname">infer</code><span class="sig-paren">(</span><em>patternNZ</em>, <em>classification</em><span class="sig-paren">)</span><a class="headerlink" href="#nupic.algorithms.sdr_classifier.SDRClassifier.infer" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the inference value from one input sample. The actual
learning happens in compute().</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>patternNZ</strong> &#8211; list of the active indices from the output below</li>
<li><strong>classification</strong> &#8211; dict of the classification information:
bucketIdx: index of the encoder bucket
actValue:  actual value going into the encoder</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><p>dict containing inference results, one entry for each step in
self.steps. The key is the number of steps, the value is an
array containing the relative likelihood for each bucketIdx
starting from bucketIdx 0.</p>
<p>for example:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="p">{</span><span class="s1">&#39;actualValues&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">]</span>
  <span class="mi">1</span> <span class="p">:</span> <span class="p">[</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.7</span><span class="p">]</span>
  <span class="mi">4</span> <span class="p">:</span> <span class="p">[</span><span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">]}</span>
</pre></div>
</div>
</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="nupic.algorithms.sdr_classifier.SDRClassifier.inferSingleStep">
<code class="descname">inferSingleStep</code><span class="sig-paren">(</span><em>patternNZ</em>, <em>weightMatrix</em><span class="sig-paren">)</span><a class="headerlink" href="#nupic.algorithms.sdr_classifier.SDRClassifier.inferSingleStep" title="Permalink to this definition">¶</a></dt>
<dd><p>Perform inference for a single step. Given an SDR input and a weight
matrix, return a predicted distribution.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>patternNZ</strong> &#8211; list of the active indices from the output below</li>
<li><strong>weightMatrix</strong> &#8211; numpy array of the weight matrix</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">numpy array of the predicted class label distribution</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="nupic.algorithms.sdr_classifier_factory.SDRClassifierFactory">
<em class="property">class </em><code class="descclassname">nupic.algorithms.sdr_classifier_factory.</code><code class="descname">SDRClassifierFactory</code><a class="headerlink" href="#nupic.algorithms.sdr_classifier_factory.SDRClassifierFactory" title="Permalink to this definition">¶</a></dt>
<dd><p>Factory for instantiating SDR classifiers.</p>
<dl class="staticmethod">
<dt id="nupic.algorithms.sdr_classifier_factory.SDRClassifierFactory.create">
<em class="property">static </em><code class="descname">create</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#nupic.algorithms.sdr_classifier_factory.SDRClassifierFactory.create" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a SDR classifier factory.
The implementation of the SDR Classifier can be specified with
the &#8220;implementation&#8221; keyword argument.</p>
<dl class="docutils">
<dt>The SDRClassifierFactory uses the implementation as specified in</dt>
<dd><a class="reference external" href="default-config.html">Default NuPIC Configuration</a>.</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="knn-classifier">
<h2>KNN Classifier<a class="headerlink" href="#knn-classifier" title="Permalink to this headline">¶</a></h2>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../../index.html">
              <img class="logo" src="../../_static/numenta-logo.png" alt="Logo"/>
            </a></p>
<h1 class="logo"><a href="../../index.html">NuPIC</a></h1>






<p>
<iframe src="https://ghbtns.com/github-btn.html?user=numenta&repo=nupic&type=watch&count=true&size=large&v=2"
  allowtransparency="true" frameborder="0" scrolling="0" width="200px" height="35px"></iframe>
</p>





<h3>Navigation</h3>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../quick-start/index.html">Quick Start</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../guides/index.html">Guides</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">API Docs</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../opf/index.html">Online Prediction Framework</a></li>
<li class="toctree-l2"><a class="reference internal" href="../network/index.html">Network API</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="index.html">Algorithms</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="encoders.html">Encoders</a></li>
<li class="toctree-l3"><a class="reference internal" href="spatial-pooling.html">Spatial Pooling</a></li>
<li class="toctree-l3"><a class="reference internal" href="sequence-memory.html">Sequence Memory</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">Classifiers</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#module-nupic.algorithms.sdr_classifier">SDR Classifier</a></li>
<li class="toctree-l4"><a class="reference internal" href="#knn-classifier">KNN Classifier</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="anomaly-detection.html">Anomaly Detection</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../data/index.html">Data</a></li>
<li class="toctree-l2"><a class="reference internal" href="../support/index.html">Support</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../contributing/index.html">Contributing</a></li>
</ul>


<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="../../search.html" method="get">
      <div><input type="text" name="q" /></div>
      <div><input type="submit" value="Go" /></div>
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2017, Numenta.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 1.5.3</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.10</a>
      
      |
      <a href="../../_sources/api/algorithms/classifiers.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    
    <a href="https://github.com/numenta/nupic" class="github">
        <img style="position: absolute; top: 0; right: 0; border: 0;" src="https://s3.amazonaws.com/github/ribbons/forkme_right_darkblue_121621.png" alt="Fork me on GitHub"  class="github"/>
    </a>
    

    
  </body>
</html>